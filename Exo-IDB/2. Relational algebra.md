
## Problem 1

$$ "Customer" join (pi_("ID", "City") sect rho_("CustID" arrow "ID", "Branch" arrow "City") (pi_("Branch", "CustID") ("Account"))$$

$pi_("ID", "City")$ :
```
ID City
1  London
2  Edin
3  London
4  Cardiff
```

$rho_("CustID" arrow "ID", "Branch" arrow "City") (pi_("Branch", "CustID") ("Account"))$  

```
ID City
1  London
1  Edin
3  London
2  London
```

 $sect arrow$   `1  London` , `3  London`
$join arrow$ `1 John London, 3 Jeff London`

## Problem 2

$$ "Customer" join (pi_("ID", "City") sect rho_("CustID" arrow "ID", "Branch" arrow "City") (pi_("Branch", "CustID") ("Account"))$$
$$ equiv "Customer" join (E_1 sect E_2)$$
$$ equiv pi_(({"ID", "Name", "City"} union {"ID", "City"})) (sigma_("ID" = "ID1" sect "City" = "City1") (rho_("ID" arrow "ID1"), rho_("City" arrow "City1") ( "Customer" times (E_1 sect E_2 ))))$$
$$ equiv E_1 - (E_1 - E_2)$$
## Problem 3

> ID and name of customers who own an account in a branch in their city.

$$ pi_("Name", "ID") (sigma_("ID" = "CustID" and "City" = "Branch") ("Customer" times "Account"))$$

> ID and name of customers who do not own any account.

$$ pi_("Name", "ID") ("Customer") - pi_("Name", "ID")(sigma_("ID" = "CustID") ("Customer" times "Account"))) $$

> ID and name of customers who own an account in every branch.

$$ (pi_("Name", "ID", "Branch") ("Customer" join_"CustID = ID" "Account") div pi_"Branch" ("Account") union \  (pi_("ID", "Name") ("Customer") join_"anti" pi_({})("Account")) $$

la projection sur account va donner soit un tuple vide (si account n'est pas vide), soit rien du tout (et dans ce cas là aucun customer ne sera enlevé car "customer - rien" = customer).

> ID and name of customers who own an account with a balance which is no less than the balance of any other account.

(en supposant que les projections sont bonnes... par exemple que quand on fait l'antijoin on enlève bien `Balance'`).
$$ "Account" - "Account" join_("Balance" < "Balance'") "Account'" $$
ensuite on fait une jointure pour récupérer le nom

## Problem 4

Oui il peut y avoir des comptes avec la même balance.